# Configure Storage Tiers (Blobs and Azure Files)

## A. Why Storage Tiers Exist

Storage in Azure has **different cost and performance profiles**. You don’t want to pay premium prices for cold data, and you don’t want cold-tier performance for hot data.

Storage tiers let you:

- Put **frequently accessed** data into fast, slightly more expensive tiers.
- Put **rarely accessed** data into cheaper tiers with higher access cost and latency.
- Automatically move data between tiers with **lifecycle management** (see separate note).

There are two main places tiers show up in AZ‑104:

1. **Blob Storage access tiers** (Hot / Cool / Cold / Archive + Premium).
2. **Azure Files tiers** (Transaction optimized / Hot / Cool + Premium).

---

## B. Blob Storage Access Tiers

### 1. Hot, Cool, Cold, Archive (Standard Blobs)

For **standard** (non-premium) blob data, Azure offers multiple access tiers. Key characteristics:

- **Hot tier**
  - Optimized for frequent access.
  - Highest storage cost per GB.
  - Lowest access (read/write) cost.
  - Default for most workloads.

- **Cool tier**
  - For infrequently accessed data that needs quick retrieval when accessed.
  - Lower storage cost than Hot.
  - Higher access costs and early deletion penalty (minimum retention period, typically 30 days).
  - Good for short-term backup, logs older than 30 days, etc.

- **Cold tier** (newer tier, think between cool and archive)
  - Lower storage cost than Cool, higher access cost.
  - For data that’s rarely accessed but must stay online.
  - Has minimum retention period; early delete charge if removed early.

- **Archive tier**
  - Lowest storage cost.
  - Highest access cost and latency.
  - Data is **offline**; you must **rehydrate** to Hot/Cool/Cold before read.
  - Minimum retention period (e.g., 180 days) and early deletion penalty.

> Exam tip: If you see **“data is rarely accessed and can take hours to restore”**, the answer is usually **Archive** tier.

### 2. Premium Blob Storage

**Premium** tiers are account types, not just an attribute on blobs:

- **Premium block blob** accounts – for low-latency, high-transaction workloads.
- **Premium page blob** accounts – used for disks.

Characteristics:

- Higher cost per GB than Hot, but much better performance.
- Typically used when you need **high IOPS and low latency**.
- Supports fewer features in some cases (check docs for specifics, but exam mainly wants conceptual understanding).

---

## C. Azure Files Tiers

For **standard SMB Azure file shares**, Azure offers **three access tiers**:

1. **Transaction optimized (default)**  
   - Balanced storage vs transaction cost.
   - Good general-purpose tier.

2. **Hot**  
   - Higher storage cost, lower transaction costs.
   - For workloads with high transaction rates (many operations).

3. **Cool**  
   - Lower storage cost, higher transaction costs.
   - For shares that store a lot of data but are infrequently accessed.

For **premium file shares** (FileStorage accounts):

- You don’t select Hot/Cool/Transaction optimized.
- You **provision capacity** (GiB), and **IOPS/throughput scale** with that size.
- Designed for high-performance scenarios.

> Exam tip: If a question talks about **standard SMB share that is infrequently accessed but large**, moving it to **Cool** tier reduces storage cost.

---

## D. Setting and Changing Tiers

### 1. Default Access Tier at Storage Account Level (Blobs)

In a **GPv2 storage account**, you can set a **default access tier**:

- **Hot** – most common default.
- **Cool** – if most data is cold-ish from the start.

This default applies to **newly created blobs**, but you can always override tier per blob.

### 2. Tier per Blob

You can change a blob’s tier by:

- Portal:
  - Select blob → **Change tier** → choose Hot/Cool/Cold/Archive.
- CLI:
  - `az storage blob set-tier --tier Hot|Cool|Cold|Archive ...`

Changing **to Archive**:

- Data becomes offline; you can’t read until rehydrated.
- Used for very cold data.

### 3. Rehydrating from Archive

To read archive data:

1. Change tier from **Archive → Hot/Cool/Cold**.
2. Choose **rehydration priority**:
   - **Standard** – cheaper, slower.
   - **High** – more expensive, faster.

Rehydration can take **hours** (depending on size and priority). Plan for this in DR and analytics scenarios.

> Exam tip: If the requirement says **“data must remain immediately available”**, **Archive** is not acceptable.

### 4. Auto-Tiering Between Hot and Cool (Blobs)

With **access time tracking** and **lifecycle management**, Azure can auto-move blobs:

- Hot → Cool → Archive after `N` days of inactivity.
- Cool → Hot on access again if **automatic tier to hot** is enabled.

Note: **Auto-tiering from Cool to Hot on access is limited to once every 30 days** to reduce early-deletion penalties and unexpected cost.

### 5. Changing Azure Files Tiers

For **standard file shares**:

- In the portal:
  - Open share → **Properties** → **Tier** → choose Transaction optimized / Hot / Cool.
- You can move shares between these tiers depending on access patterns.

For **premium file shares**:

- Change the **provisioned size**; this adjusts performance.

---

## E. Cost & Billing Considerations (High-Level)

Key ideas (you don’t need exact prices for the exam, just behavior):

- **Hot tier** – pay more for storage, less for access.
- **Cool/Cold** – pay less for storage, more for access, and for **early deletion** (if deleted before minimum retention).
- **Archive** – cheapest at rest, very expensive to read/rehydrate, and cannot access directly.
- **Soft-deleted** data and previous versions are **billed like active data** while retained (for both blobs and files).

> Exam angle: Many questions are about **picking the cheapest option that still meets access requirements**.

---

## F. Example Tiering Strategies

### Example 1 – Log Data Lifecycle

A company stores logs for 1 year:

- First 30 days: read frequently for troubleshooting.
- Next 90 days: occasional access.
- After 120 days: rare, mostly for audit.

A good lifecycle policy:

- Store new logs in **Hot**.
- After 30 days → move to **Cool**.
- After additional 90 days (120 total) → move to **Archive**.
- After 365 days → delete.

You can implement this using **blob lifecycle management** rules (see dedicated note).

### Example 2 – Backup Files

Backups required for 7 years, but rarely restored:

- Upload directly to **Cool** or **Cold** if you don’t need frequent access.
- Optionally archive after 180 days.
- Keep until compliance requirement met, then delete.

### Example 3 – Multimedia Content

Media files that users stream frequently:

- Use **Hot** tier for fast access and predictable performance.
- Consider Premium for very latency-sensitive workloads.

---

## G. Exam-Style Scenarios

### Scenario 1

> You have 50 TB of application logs that must be kept for one year but are rarely accessed after 30 days. What should you do to minimize cost?

**Answer reasoning**:

- Use **Hot** tier for first 30 days (frequent access).
- After 30 days, use **lifecycle policy** to move logs to **Cool** or **Cold**, and optionally **Archive** later.
- After 1 year, delete them.

### Scenario 2

> A healthcare application stores medical images that are accessed a few times in the first month, then rarely. They must be available within minutes if accessed. Which tiers?

**Answer**:

- First month: **Hot**.
- After one month: **Cool** or **Cold** (still online with reasonable latency).
- **Not Archive** because Archive can take hours to restore.

### Scenario 3

> A VDI environment requires extremely low latency for profile disks. Which storage tier or account type?

**Answer**:

- Use **Premium file shares** (FileStorage) – not standard Hot/Cool.

---

## H. Quick Summary for the Exam

- Blob tiers: **Hot / Cool / Cold / Archive / Premium**.
- File share tiers (standard SMB): **Transaction optimized / Hot / Cool**; plus **Premium** for high performance.
- **Hot** for frequently accessed data; **Cool/Cold** for infrequent; **Archive** for long-term rarely accessed data.
- Archive data must be **rehydrated** before read; can take hours.
- Use **lifecycle management** to automatically move or delete data based on age or last access.
- Be aware of **minimum retention** and **early deletion penalties** for Cool/Cold/Archive.